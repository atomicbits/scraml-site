<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Quickstart Scala</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./pygments-friendly.css">
</head>
<body class="article">
<div id="header">
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_quickstart_scala">Quickstart Scala</a></li>
<li><a href="#_raml_basics">RAML basics</a>
<ul class="sectlevel2">
<li><a href="#_resource_definitions_and_json_schema">Resource definitions and json-schema</a></li>
</ul>
</li>
<li><a href="#_invoking_scraml">Invoking Scraml</a>
<ul class="sectlevel2">
<li><a href="#_cross_referencing_json_schemas">Cross-referencing json-schemas</a></li>
<li><a href="#_generated_case_classes">Generated case classes</a></li>
<li><a href="#_scraml_typesafe_asynchronous_dsl">Scraml typesafe asynchronous DSL</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_quickstart_scala">Quickstart Scala</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Will be added as soon as the first release of <span class="scramlfont">Scraml</span> is there (expected by the end of november 2015).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_raml_basics">RAML basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Documentation, tutorials and detailed information about writing RAML documents are found on the RAML main website <a href="http://raml.org" class="bare">http://raml.org</a>. This
section will teach you some basics to get you started.</p>
</div>
<div class="sect2">
<h3 id="_resource_definitions_and_json_schema">Resource definitions and json-schema</h3>
<div class="paragraph">
<p>In code listing <a href="#raml-simple">a simple resource definition</a>, we see a resource hosted on <code>\rest\user</code> that provides a <code>GET</code> action that takes two query parameters
<code>firstName</code> and <code>lastName</code>. The resulting body has a result type <code>application/json</code> that matches the expected accept header and refers
to the JSON data this service returns. This JSON data is further defined by the schema <code>user</code>. The <code>!include</code> keyword includes the content
of the referenced file into the document. A single RAML definition has exactly one main entry file that bootstraps the inclusion of other
files whenever it is needed to structure the documents.</p>
</div>
<div id="raml-simple" class="listingblock">
<div class="title">a simple resource definition</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"><span class="tok-c1">#%RAML 0.8</span>
<span class="tok-nn">---</span>
<span class="tok-l-Scalar-Plain">title</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">raml example</span>
<span class="tok-l-Scalar-Plain">version</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">v1</span>

<span class="tok-l-Scalar-Plain">schemas</span><span class="tok-p-Indicator">:</span>
  <span class="tok-p-Indicator">-</span> <span class="tok-l-Scalar-Plain">user</span><span class="tok-p-Indicator">:</span>         <span class="tok-kt">!include</span> <span class="tok-l-Scalar-Plain">schemas/user.json</span>

<span class="tok-l-Scalar-Plain">/rest/user</span><span class="tok-p-Indicator">:</span>
  <span class="tok-l-Scalar-Plain">get</span><span class="tok-p-Indicator">:</span>
    <span class="tok-l-Scalar-Plain">queryParameters</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">firstName</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">The firstname of the user.</span>
        <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">string</span>
      <span class="tok-l-Scalar-Plain">lastName</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">The last name of the user.</span>
        <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">string</span>
    <span class="tok-l-Scalar-Plain">responses</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">200</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">body</span><span class="tok-p-Indicator">:</span>
          <span class="tok-l-Scalar-Plain">application/json</span><span class="tok-p-Indicator">:</span>
            <span class="tok-l-Scalar-Plain">schema</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">user</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A <a href="http://json-schema.org/">json-schema</a> file describes the rules to which a JSON object needs to adhere. In the example of the <code>user.json</code>
we see a schema definition with type <code>object</code> that has three properties <code>firstName</code> and <code>lastName</code> (these are strings) and <code>age</code>
(an integer).</p>
</div>
<div class="paragraph">
<p>Notice that the json-schema begins with two special fields: <code>$schema</code> and <code>id</code>. The <code>$schema</code> is a version identifier for the
json-schema version that you use. According to the specs, it is a required keyword at the beginning of a json-schema file, but
<span class="scramlfont">Scraml</span> won&#8217;t use it for any specific purpose. The <code>id</code> field in a json-schema on the other hand is <strong>essential for
cross-referencing</strong> between json-schemas! Therefore, <span class="scramlfont">Scraml</span> requires you to specify one on each json-schema file! The
format should be of the form <code><a href="http://atomicbits.io/api/user.json" class="bare">http://atomicbits.io/api/user.json</a></code> and may end with a <code>#</code>. If the schema refers to an object,
the canonical name of the object will be deduced from its <code>id</code>. In this case <code>io.atomicbits.api.User</code> will be the canonical object name
that will recur in the generated Scala case class representation of a user.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
It is essential for cross-referencing objects that each json-schema has a unique <code>id</code> field! <span class="scramlfont">Scraml</span> requires it.
</td>
</tr>
</table>
</div>
<div id="json-simple" class="listingblock">
<div class="title">the json-schema for the user object schemas/user.json</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-p">{</span>
  <span class="tok-nt">&quot;$schema&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://json-schema.org/draft-03/schema&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://atomicbits.io/api/user.json#&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;object&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;A user object.&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;properties&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;firstName&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;lastName&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;age&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;integer&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_invoking_scraml">Invoking Scraml</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The effect of having written a RAML model becomes very cool when you start using <span class="scramlfont">Scraml</span> to generate Scala code that
brings you a typesafe and asynchronous Domain Specific Language (DSL) that will enforce you in a fluent manner to follow your RAML specs.</p>
</div>
<div class="paragraph">
<p>The sample code that we use here is based on the Scala test project for <span class="scramlfont">Scraml</span>:
<a href="https://github.com/atomicbits/scraml-test-scala" class="bare">https://github.com/atomicbits/scraml-test-scala</a>. You can checkout the full codebase there and play with the RAML definition and the test
classes that showcase the DSL.</p>
</div>
<div class="paragraph">
<p>In the next sections, we first introduce the generation of case classes from json-schema followed by the integration of those typed
Data Transfer Objects (DTOs) in the <span class="scramlfont">Scraml</span> DSL. Then we go deeper into the more advanced features that <span class="scramlfont">Scraml</span>
offers.</p>
</div>
<div class="sect2">
<h3 id="_cross_referencing_json_schemas">Cross-referencing json-schemas</h3>
<div class="paragraph">
<p>The example in <a href="#json-user">a more extensive json-schema for a user</a> shows us a nested json-schema definition in which an object (an address) is defined inside the schema for a
user object. The address has a <code>fragment id</code> in this case: #/definitions/address and it wasn&#8217;t necessary to set the id explicitly
in this case because it is also deduced from its relative path inside its enclosing schema. The address object is referenced to from
the address field in the user object: <code>"$ref": "#/definitions/address"</code>.</p>
</div>
<div id="json-user" class="listingblock">
<div class="title">a more extensive json-schema for a user</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-p">{</span>
  <span class="tok-nt">&quot;$schema&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://json-schema.org/draft-03/schema&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://atomicbits.io/schema/user.json#&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;object&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;A user object.&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;definitions&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;address&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;#/definitions/address&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;object&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;properties&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
        <span class="tok-nt">&quot;streetAddress&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span> <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span> <span class="tok-p">},</span>
        <span class="tok-nt">&quot;city&quot;</span><span class="tok-p">:</span>          <span class="tok-p">{</span> <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span> <span class="tok-p">},</span>
        <span class="tok-nt">&quot;state&quot;</span><span class="tok-p">:</span>         <span class="tok-p">{</span> <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span> <span class="tok-p">}</span>
      <span class="tok-p">},</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;streetAddress&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;city&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;state&quot;</span><span class="tok-p">]</span>
    <span class="tok-p">}</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;properties&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;firstName&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;lastName&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;age&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;integer&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;homePage&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;$ref&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;link.json&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;address&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;$ref&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;#/definitions/address&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A more common approach to refer to another object is defining the object in another schema file and refer to its absolute <code>id</code>.
The <code>homePage</code> field of the user object refers to <code>"$ref": "link.json"</code>. This reference is an relative reference and it is completed
by the anchor of the id of the enclosing user schema: <code><a href="http://atomicbits.io/schema/" class="bare">http://atomicbits.io/schema/</a></code>, so the full reference becomes:
<code><a href="http://atomicbits.io/schema/link.json" class="bare">http://atomicbits.io/schema/link.json</a></code>. So there must be another json-schema file included in the RAML model that has exactly this id.
Mind the different approaches to define the required fields in the address object versus the user object. Both approaches are properly
interpreted by <span class="scramlfont">Scraml</span> (see further for the different handling of required versus non-required fields).</p>
</div>
<div class="paragraph">
<p>The <a href="#json-link">link object</a> object and the <a href="#json-method">method enumeration</a> complete the user object and the objects it refers to.</p>
</div>
<div id="json-link" class="listingblock">
<div class="title">link object</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-p">{</span>
  <span class="tok-nt">&quot;$schema&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://json-schema.org/draft-03/schema&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://atomicbits.io/schema/link.json#&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;object&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;A href&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;properties&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;href&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;method&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;$ref&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;method.json&quot;</span>
    <span class="tok-p">},</span>
    <span class="tok-nt">&quot;accept&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;required&quot;</span><span class="tok-p">:</span> <span class="tok-kc">false</span>
    <span class="tok-p">}</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div id="json-method" class="listingblock">
<div class="title">method enumeration</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span class="tok-p">{</span>
  <span class="tok-nt">&quot;$schema&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://json-schema.org/draft-03/schema&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://atomicbits.io/schema/method.json#&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;enum&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span> <span class="tok-s2">&quot;GET&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;PUT&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;POST&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;DELETE&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;HEAD&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;CONNECT&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;TRACE&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;OPTIONS&quot;</span> <span class="tok-p">]</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s see how the generated case classes look like.</p>
</div>
</div>
<div class="sect2">
<h3 id="_generated_case_classes">Generated case classes</h3>
<div class="paragraph">
<p>The <a href="#scala-user">User case class</a> reflects the fields described by the corresponding json-schema. Notice that the types of the fields that were not
required (such as homePage) are wrapped in the <code>Option</code> monad. The address object has a strange canonical name that is a result of the
somewhat unconventional <code>id</code> that we gave in the nested json-schema example. All optional fields have a default value of <code>None</code>, which
shortens the construction of those case classes when the values of those fields are empty. The <a href="#scala-link">Link case class</a> is referred to by the User
object (the <code>homePage</code> field). Because both classes are in the same package, the import statement to the Link class in User is omitted.</p>
</div>
<div id="scala-user" class="listingblock">
<div class="title">User case class</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span class="tok-k">package</span> <span class="tok-nn">io.atomicbits.schema</span>

<span class="tok-k">import</span> <span class="tok-nn">play.api.libs.json._</span>

<span class="tok-k">case</span> <span class="tok-k">class</span> <span class="tok-nc">User</span><span class="tok-o">(</span><span class="tok-n">age</span><span class="tok-k">:</span> <span class="tok-kt">Long</span><span class="tok-o">,</span>
                <span class="tok-n">lastName</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">,</span>
                <span class="tok-n">firstName</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">,</span>
                <span class="tok-n">id</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">,</span>
                <span class="tok-n">homePage</span><span class="tok-k">:</span> <span class="tok-kt">Option</span><span class="tok-o">[</span><span class="tok-kt">Link</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">None</span><span class="tok-o">,</span>
                <span class="tok-n">address</span><span class="tok-k">:</span> <span class="tok-kt">Option</span><span class="tok-o">[</span><span class="tok-kt">UserDefinitionsAddress</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">None</span><span class="tok-o">)</span>

<span class="tok-k">object</span> <span class="tok-nc">User</span> <span class="tok-o">{</span>

  <span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">jsonFormatter</span><span class="tok-k">:</span> <span class="tok-kt">Format</span><span class="tok-o">[</span><span class="tok-kt">User</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">Json</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-o">[</span><span class="tok-kt">User</span><span class="tok-o">]</span>

<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>JSON serialization is done with play-json 2.4, hence the dependency on <code>play.api.libs.json._</code> (together with ning our only external
dependencies to use the DSL). The formatters are defined in the companion objects.</p>
</div>
<div id="scala-link" class="listingblock">
<div class="title">Link case class</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span class="tok-k">package</span> <span class="tok-nn">io.atomicbits.schema</span>

<span class="tok-k">import</span> <span class="tok-nn">play.api.libs.json._</span>

<span class="tok-k">case</span> <span class="tok-k">class</span> <span class="tok-nc">Link</span><span class="tok-o">(</span><span class="tok-n">href</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">,</span>
                <span class="tok-n">method</span><span class="tok-k">:</span> <span class="tok-kt">Method</span><span class="tok-o">,</span>
                <span class="tok-n">accept</span><span class="tok-k">:</span> <span class="tok-kt">Option</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">None</span><span class="tok-o">)</span>

<span class="tok-k">object</span> <span class="tok-nc">Link</span> <span class="tok-o">{</span>

  <span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">jsonFormatter</span><span class="tok-k">:</span> <span class="tok-kt">Format</span><span class="tok-o">[</span><span class="tok-kt">Link</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">Json</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-o">[</span><span class="tok-kt">Link</span><span class="tok-o">]</span>

<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Enumerations like the <a href="#scala-method">Method enumeration</a> are implemented as a sealed trait with a name field and case objects for each choice in its
companion object. JSON serialization goes directly to the name of the choice as a string without wrapper object.</p>
</div>
<div id="scala-method" class="listingblock">
<div class="title">Method enumeration</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span class="tok-k">package</span> <span class="tok-nn">io.atomicbits.schema</span>

<span class="tok-k">import</span> <span class="tok-nn">play.api.libs.json.</span><span class="tok-o">{</span><span class="tok-nc">Format</span><span class="tok-o">,</span> <span class="tok-nc">Json</span><span class="tok-o">,</span> <span class="tok-nc">JsResult</span><span class="tok-o">,</span> <span class="tok-nc">JsValue</span><span class="tok-o">,</span> <span class="tok-nc">JsString</span><span class="tok-o">}</span>

<span class="tok-k">sealed</span> <span class="tok-k">trait</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">name</span><span class="tok-k">:</span> <span class="tok-kt">String</span>
<span class="tok-o">}</span>

<span class="tok-k">object</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>

  <span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">GET</span> <span class="tok-k">extends</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">name</span> <span class="tok-k">=</span> <span class="tok-s">&quot;GET&quot;</span>
  <span class="tok-o">}</span>

  <span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">PUT</span> <span class="tok-k">extends</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">name</span> <span class="tok-k">=</span> <span class="tok-s">&quot;PUT&quot;</span>
  <span class="tok-o">}</span>

  <span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">POST</span> <span class="tok-k">extends</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">name</span> <span class="tok-k">=</span> <span class="tok-s">&quot;POST&quot;</span>
  <span class="tok-o">}</span>

  <span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">DELETE</span> <span class="tok-k">extends</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">name</span> <span class="tok-k">=</span> <span class="tok-s">&quot;DELETE&quot;</span>
  <span class="tok-o">}</span>

  <span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">HEAD</span> <span class="tok-k">extends</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">name</span> <span class="tok-k">=</span> <span class="tok-s">&quot;HEAD&quot;</span>
  <span class="tok-o">}</span>

  <span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">CONNECT</span> <span class="tok-k">extends</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">name</span> <span class="tok-k">=</span> <span class="tok-s">&quot;CONNECT&quot;</span>
  <span class="tok-o">}</span>

  <span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">TRACE</span> <span class="tok-k">extends</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">name</span> <span class="tok-k">=</span> <span class="tok-s">&quot;TRACE&quot;</span>
  <span class="tok-o">}</span>

  <span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">OPTIONS</span> <span class="tok-k">extends</span> <span class="tok-nc">Method</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">name</span> <span class="tok-k">=</span> <span class="tok-s">&quot;OPTIONS&quot;</span>
  <span class="tok-o">}</span>

  <span class="tok-k">val</span> <span class="tok-n">byName</span> <span class="tok-k">=</span> <span class="tok-nc">Map</span><span class="tok-o">(</span>
    <span class="tok-nc">GET</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">→</span> <span class="tok-nc">GET</span><span class="tok-o">,</span> <span class="tok-nc">PUT</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">→</span> <span class="tok-nc">PUT</span><span class="tok-o">,</span> <span class="tok-nc">POST</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">→</span> <span class="tok-nc">POST</span><span class="tok-o">,</span> <span class="tok-nc">DELETE</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">→</span> <span class="tok-nc">DELETE</span><span class="tok-o">,</span> <span class="tok-nc">HEAD</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">→</span> <span class="tok-nc">HEAD</span><span class="tok-o">,</span> <span class="tok-nc">CONNECT</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">→</span> <span class="tok-nc">CONNECT</span><span class="tok-o">,</span> <span class="tok-nc">TRACE</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">→</span> <span class="tok-nc">TRACE</span><span class="tok-o">,</span> <span class="tok-nc">OPTIONS</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">→</span> <span class="tok-nc">OPTIONS</span>
  <span class="tok-o">)</span>

  <span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-nc">MethodFormat</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Format</span><span class="tok-o">[</span><span class="tok-kt">Method</span><span class="tok-o">]</span> <span class="tok-o">{</span>

    <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">reads</span><span class="tok-o">(</span><span class="tok-n">json</span><span class="tok-k">:</span> <span class="tok-kt">JsValue</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">JsResult</span><span class="tok-o">[</span><span class="tok-kt">Method</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
      <span class="tok-n">json</span><span class="tok-o">.</span><span class="tok-n">validate</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">].</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-nc">Method</span><span class="tok-o">.</span><span class="tok-n">byName</span><span class="tok-o">(</span><span class="tok-k">_</span><span class="tok-o">))</span>
    <span class="tok-o">}</span>

    <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">writes</span><span class="tok-o">(</span><span class="tok-n">o</span><span class="tok-k">:</span> <span class="tok-kt">Method</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">JsValue</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
      <span class="tok-nc">JsString</span><span class="tok-o">(</span><span class="tok-n">o</span><span class="tok-o">.</span><span class="tok-n">name</span><span class="tok-o">)</span>
    <span class="tok-o">}</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scraml_typesafe_asynchronous_dsl">Scraml typesafe asynchronous DSL</h3>
<div class="paragraph">
<p>Now that we have a feeling of how the DTOs look like, we can start to explain how <span class="scramlfont">Scraml</span> turns the RAML resource definitions
into a typesafe DSL. Below, a <a href="#raml-userservice">user service</a> is modeled in RAML using the json-schema definition of <code>user.json</code>, <code>link.json</code> and
<code>method.json</code> that we introduced before.</p>
</div>
<div class="paragraph">
<p>We defined a <code>/rest/user/' resource with a `GET</code> action on it that takes several query parameters. Notice that one of the query parameters
has a <code>repeat: true</code> definition on it. We&#8217;ll see in a minute how that translates into the DSL. The result body is of type <code>application/json</code>
and more concrete an array of User objects. Here the json-schema definition is defined inline. Mind that the <code>id</code> is currently still
necessary on inline schemas even if they aren&#8217;t an unique object definion. In a future release, <code>id</code> fields will not be mandatory on inline
schemas.</p>
</div>
<div class="paragraph">
<p>Next, we have a <code>multipart/form-data</code> POST action on <code>/rest/user/upload</code> and a resource that takes URL-parameters: <code>/rest/user/{userid}</code>.
The <code>userid</code> URL-parameter is defined as a string and <span class="scramlfont">Scraml</span> will enforce this. There is a form-POST action on
this resource with a required and a non-required form field. The response will have a JSON format, but it is not defined which schema it
follows. This will imply that we don&#8217;t have type information in the DSL on that response. Finally, we have a DELETE action and a
POST action that sends a User and receives a Link.</p>
</div>
<div id="raml-userservice" class="listingblock">
<div class="title">user service</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="yaml"><span class="tok-c1">#%RAML 0.8</span>
<span class="tok-nn">---</span>
<span class="tok-l-Scalar-Plain">title</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">My api</span>
<span class="tok-l-Scalar-Plain">version</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">v1</span>

<span class="tok-l-Scalar-Plain">schemas</span><span class="tok-p-Indicator">:</span>
  <span class="tok-p-Indicator">-</span> <span class="tok-l-Scalar-Plain">link</span><span class="tok-p-Indicator">:</span>         <span class="tok-kt">!include</span> <span class="tok-l-Scalar-Plain">schemas/link.json</span>
  <span class="tok-p-Indicator">-</span> <span class="tok-l-Scalar-Plain">method</span><span class="tok-p-Indicator">:</span>       <span class="tok-kt">!include</span> <span class="tok-l-Scalar-Plain">schemas/method.json</span>
  <span class="tok-p-Indicator">-</span> <span class="tok-l-Scalar-Plain">user</span><span class="tok-p-Indicator">:</span>         <span class="tok-kt">!include</span> <span class="tok-l-Scalar-Plain">schemas/user.json</span>

<span class="tok-l-Scalar-Plain">/rest/user/</span><span class="tok-p-Indicator">:</span>
  <span class="tok-l-Scalar-Plain">get</span><span class="tok-p-Indicator">:</span>
    <span class="tok-l-Scalar-Plain">queryParameters</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">age</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">The age of the user.</span>
        <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">number</span>
      <span class="tok-l-Scalar-Plain">firstName</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">The firstname of the user.</span>
        <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">string</span>
      <span class="tok-l-Scalar-Plain">lastName</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">The last name of the user.</span>
        <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">string</span>
      <span class="tok-l-Scalar-Plain">organization</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">The organization of the user.</span>
        <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">string</span>
        <span class="tok-l-Scalar-Plain">repeat</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">true</span>
    <span class="tok-l-Scalar-Plain">responses</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">200</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">body</span><span class="tok-p-Indicator">:</span>
          <span class="tok-l-Scalar-Plain">application/json</span><span class="tok-p-Indicator">:</span>
            <span class="tok-l-Scalar-Plain">schema</span><span class="tok-p-Indicator">:</span> <span class="tok-p-Indicator">|</span>
              <span class="tok-no">{</span>
                <span class="tok-no">&quot;id&quot;: &quot;http://atomicbits.io/schema/anonymous1.json&quot;,</span>
                <span class="tok-no">&quot;type&quot;: &quot;array&quot;,</span>
                <span class="tok-no">&quot;items&quot;: {</span>
                  <span class="tok-no">&quot;$ref&quot;: &quot;user.json&quot;</span>
                <span class="tok-no">}</span>
              <span class="tok-no">}</span>


<span class="tok-l-Scalar-Plain">/rest/user/upload</span><span class="tok-p-Indicator">:</span>
  <span class="tok-l-Scalar-Plain">post</span><span class="tok-p-Indicator">:</span>
    <span class="tok-l-Scalar-Plain">body</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">multipart/form-data</span><span class="tok-p-Indicator">:</span>
    <span class="tok-l-Scalar-Plain">responses</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">200</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">body</span><span class="tok-p-Indicator">:</span>

<span class="tok-l-Scalar-Plain">/rest/user/{userid}</span><span class="tok-p-Indicator">:</span>
  <span class="tok-l-Scalar-Plain">uriParameters</span><span class="tok-p-Indicator">:</span>
    <span class="tok-l-Scalar-Plain">userid</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">The user&#39;s id.</span>
      <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">string</span>
      <span class="tok-l-Scalar-Plain">required</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">true</span>
  <span class="tok-l-Scalar-Plain">post</span><span class="tok-p-Indicator">:</span>
    <span class="tok-l-Scalar-Plain">body</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">application/x-www-form-urlencoded</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">formParameters</span><span class="tok-p-Indicator">:</span>
          <span class="tok-l-Scalar-Plain">text</span><span class="tok-p-Indicator">:</span>
            <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">Text to post as a comment on the user.</span>
            <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">string</span>
            <span class="tok-l-Scalar-Plain">required</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">true</span>
          <span class="tok-l-Scalar-Plain">value</span><span class="tok-p-Indicator">:</span>
            <span class="tok-l-Scalar-Plain">description</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">Value to give to a user.</span>
            <span class="tok-l-Scalar-Plain">type</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">integer</span>
            <span class="tok-l-Scalar-Plain">required</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">false</span>
    <span class="tok-l-Scalar-Plain">responses</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">200</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">body</span><span class="tok-p-Indicator">:</span>
  <span class="tok-l-Scalar-Plain">delete</span><span class="tok-p-Indicator">:</span>
  <span class="tok-l-Scalar-Plain">put</span><span class="tok-p-Indicator">:</span>
    <span class="tok-l-Scalar-Plain">body</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">application/json</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">schema</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">user</span>
    <span class="tok-l-Scalar-Plain">responses</span><span class="tok-p-Indicator">:</span>
      <span class="tok-l-Scalar-Plain">200</span><span class="tok-p-Indicator">:</span>
        <span class="tok-l-Scalar-Plain">body</span><span class="tok-p-Indicator">:</span>
          <span class="tok-l-Scalar-Plain">application/json</span><span class="tok-p-Indicator">:</span>
            <span class="tok-l-Scalar-Plain">schema</span><span class="tok-p-Indicator">:</span> <span class="tok-l-Scalar-Plain">link</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Compiling the codebase using sbt, <span class="scramlfont">Scraml</span> will generate the DSL in the code generation step before actual compilation. This
results in a client that provides access to the resources we described above. Let&#8217;s assume the above RAML file sits in the folder
<code>io/atomicbits/api/</code> under the resources folder and the filename is <code>user-api.raml</code>. The resulting DSL can be used to do the following.</p>
</div>
<div id="scala-client" class="listingblock">
<div class="title">client DSL code</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala">  <span class="tok-k">import</span> <span class="tok-nn">io.atomicbits.api.UserApi</span>
  <span class="tok-o">...</span>
  <span class="tok-k">val</span> <span class="tok-n">client</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">UserApi</span><span class="tok-o">(</span>
    <span class="tok-n">host</span> <span class="tok-k">=</span> <span class="tok-s">&quot;somehost&quot;</span><span class="tok-o">,</span>
    <span class="tok-n">port</span> <span class="tok-k">=</span> <span class="tok-mi">80</span><span class="tok-o">,</span>
    <span class="tok-n">protocol</span> <span class="tok-k">=</span> <span class="tok-s">&quot;http&quot;</span><span class="tok-o">,</span>
    <span class="tok-n">defaultHeaders</span> <span class="tok-k">=</span> <span class="tok-nc">Map</span><span class="tok-o">(</span><span class="tok-s">&quot;Accept&quot;</span> <span class="tok-o">-&gt;</span> <span class="tok-s">&quot;application/json&quot;</span><span class="tok-o">),</span>
    <span class="tok-n">prefix</span> <span class="tok-k">=</span> <span class="tok-nc">None</span><span class="tok-o">,</span>
    <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ClientConfig</span><span class="tok-o">()</span>
  <span class="tok-o">)</span>

  <span class="tok-k">val</span> <span class="tok-n">userResource</span> <span class="tok-k">=</span> <span class="tok-n">client</span><span class="tok-o">.</span><span class="tok-n">rest</span><span class="tok-o">.</span><span class="tok-n">user</span>
  <span class="tok-k">val</span> <span class="tok-n">userFoobarResource</span> <span class="tok-k">=</span> <span class="tok-n">userResource</span><span class="tok-o">.</span><span class="tok-n">userid</span><span class="tok-o">(</span><span class="tok-s">&quot;foobar&quot;</span><span class="tok-o">)</span>

  <span class="tok-k">val</span> <span class="tok-n">eventualUserResponse</span><span class="tok-k">:</span> <span class="tok-kt">Future</span><span class="tok-o">[</span><span class="tok-kt">List</span><span class="tok-o">[</span><span class="tok-kt">User</span><span class="tok-o">]]</span> <span class="tok-k">=</span>
    <span class="tok-n">userResource</span>
      <span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-o">(</span>
        <span class="tok-n">age</span> <span class="tok-k">=</span> <span class="tok-nc">Some</span><span class="tok-o">(</span><span class="tok-mi">51</span><span class="tok-o">),</span>
        <span class="tok-n">firstName</span> <span class="tok-k">=</span> <span class="tok-nc">Some</span><span class="tok-o">(</span><span class="tok-s">&quot;John&quot;</span><span class="tok-o">),</span>
        <span class="tok-n">lastName</span> <span class="tok-k">=</span> <span class="tok-nc">None</span><span class="tok-o">,</span>
        <span class="tok-n">organization</span> <span class="tok-k">=</span> <span class="tok-nc">List</span><span class="tok-o">(</span><span class="tok-s">&quot;ESA&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;NASA&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">asType</span>

  <span class="tok-k">val</span> <span class="tok-n">userResponse</span><span class="tok-k">:</span> <span class="tok-kt">List</span><span class="tok-o">[</span><span class="tok-kt">User</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">Await</span><span class="tok-o">.</span><span class="tok-n">result</span><span class="tok-o">(</span><span class="tok-n">eventualUserResponse</span><span class="tok-o">,</span> <span class="tok-mi">2</span> <span class="tok-n">seconds</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-11-04 21:34:35 CET
</div>
</div>
</body>
</html>